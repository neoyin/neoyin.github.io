<!DOCTYPE html>
<html lang>
  <head><meta name="generator" content="Hexo 3.9.0">
    
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,minimum-scale=1,maximum-scale=1">


<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">



  <meta name="description" content="React-native Android打离线APK">




  <meta name="keywords" content="react-native,">





    <link rel="alternate" href="/default" title="浮生若梦">




    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=1.1">



<link rel="canonical" href="http://yoursite.com/2016/05/06/react-native-android-offline-apk/">


<meta name="description" content="项目配置 项目package.json 如下  1234567891011121314&amp;#123;  &amp;quot;name&amp;quot;: &amp;quot;news&amp;quot;,  &amp;quot;version&amp;quot;: &amp;quot;0.0.1&amp;quot;,  &amp;quot;private&amp;quot;: true,  &amp;quot;scripts&amp;quot;: &amp;#123;    &amp;quot;start">
<meta name="keywords" content="react-native">
<meta property="og:type" content="article">
<meta property="og:title" content="React-native Android打离线APK">
<meta property="og:url" content="http://yoursite.com/2016/05/06/react-native-android-offline-apk/index.html">
<meta property="og:site_name" content="浮生若梦">
<meta property="og:description" content="项目配置 项目package.json 如下  1234567891011121314&amp;#123;  &amp;quot;name&amp;quot;: &amp;quot;news&amp;quot;,  &amp;quot;version&amp;quot;: &amp;quot;0.0.1&amp;quot;,  &amp;quot;private&amp;quot;: true,  &amp;quot;scripts&amp;quot;: &amp;#123;    &amp;quot;start">
<meta property="og:locale" content="cn">
<meta property="og:updated_time" content="2020-03-13T14:33:53.440Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="React-native Android打离线APK">
<meta name="twitter:description" content="项目配置 项目package.json 如下  1234567891011121314&amp;#123;  &amp;quot;name&amp;quot;: &amp;quot;news&amp;quot;,  &amp;quot;version&amp;quot;: &amp;quot;0.0.1&amp;quot;,  &amp;quot;private&amp;quot;: true,  &amp;quot;scripts&amp;quot;: &amp;#123;    &amp;quot;start">


<link rel="stylesheet" type="text/css" href="/css/style.css?v=1.1">
<link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">





<script type="text/javascript">
  var themeConfig = {
    fancybox: {
      enable: false
    },
  };
</script>




    





    





    <title> React-native Android打离线APK - 浮生若梦 </title>
  </head>

  <body>
    <div id="page">
      <header id="masthead"><div class="site-header-inner">
    <h1 class="site-title">
        <a href="/." class="logo">浮生若梦</a>
    </h1>

    <nav id="nav-top">
        
            <ul id="menu-top" class="nav-top-items">
                
                    <li class="menu-item">
                        <a href="/archives">
                            
                            
                                Archives
                            
                        </a>
                    </li>
                
                    <li class="menu-item">
                        <a href="/about">
                            
                            
                                About
                            
                        </a>
                    </li>
                
                
            </ul>
        
    </nav>

</div>

      </header>
      <div id="content">
        
    <div id="primary">
        
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          React-native Android打离线APK
        
      </h1>

      <time class="post-time">
          May 6 2016
      </time>
    </header>



    
            <div class="post-content">
            <hr>
<h4 id="项目配置"><a href="#项目配置" class="headerlink" title="项目配置"></a>项目配置</h4><ul>
<li>项目<code>package.json</code> 如下</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;name&quot;: &quot;news&quot;,</span><br><span class="line">  &quot;version&quot;: &quot;0.0.1&quot;,</span><br><span class="line">  &quot;private&quot;: true,</span><br><span class="line">  &quot;scripts&quot;: &#123;</span><br><span class="line">    &quot;start&quot;: &quot;node node_modules/react-native/local-cli/cli.js start&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;dependencies&quot;: &#123;</span><br><span class="line">    &quot;react&quot;: &quot;^0.14.8&quot;,</span><br><span class="line">    &quot;react-native&quot;: &quot;^0.25.1&quot;,</span><br><span class="line">    &quot;react-native-umeng-push&quot;: &quot;^1.0.3&quot;,</span><br><span class="line">    &quot;react-native-xtabbar&quot;: &quot;^0.1.8&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>项目引入了友盟消息Push 使用了相关react-native项目<a href="https://github.com/liuchungui/react-native-umeng-push" target="_blank" rel="noopener">https://github.com/liuchungui/react-native-umeng-push</a> </li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"> # 需先安装rnpm </span><br><span class="line">npm install rnpm -g</span><br><span class="line">再安装依赖 </span><br><span class="line">rnpm install react-native-umeng-push</span><br></pre></td></tr></table></figure>

<ul>
<li>项目 <code>settings.gradle</code>如下</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">rootProject.name = &apos;XXX&apos;</span><br><span class="line">include &apos;:app&apos;</span><br><span class="line"> # 这里引入了两个工程</span><br><span class="line">include &apos;:react-native-umeng-push&apos;</span><br><span class="line">project(&apos;:react-native-umeng-push&apos;).projectDir = new File(rootProject.projectDir, &apos;../node_modules/react-native-umeng-push/android&apos;)</span><br><span class="line">include &apos;:PushSDK&apos;</span><br><span class="line">project(&apos;:PushSDK&apos;).projectDir = new File(rootProject.projectDir, &apos;../node_modules/react-native-umeng-sdk/android/PushSDK&apos;)</span><br></pre></td></tr></table></figure>

<ul>
<li>在项目<code>build.gradle</code>中添加</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line">    compile project(&apos;:react-native-umeng-push&apos;)</span><br><span class="line">    compile fileTree(dir: &quot;libs&quot;, include: [&quot;*.jar&quot;])</span><br><span class="line">    compile &quot;com.android.support:appcompat-v7:23.0.1&quot;</span><br><span class="line">    compile &quot;com.facebook.react:react-native:+&quot;  // From node_modules</span><br><span class="line">    compile &apos;com.umeng.analytics:analytics:latest.integration&apos;</span><br><span class="line">    compile project(&apos;:PushSDK&apos;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>生成keystore<br><code>keytool -genkey -v -keystore xxx.keystore -alias xxx -keyalg RSA -keysize 2048 -validity 10000</code></li>
<li>将生成的keystore放入项目目录中 <ul>
<li>在<code>build.gradle</code>中添加签名配置</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">//签名配置</span><br><span class="line">    signingConfigs &#123;</span><br><span class="line">        release &#123;</span><br><span class="line">            storeFile file(&quot;xxx.keystore&quot;)</span><br><span class="line">            keyAlias &quot;xxx&quot;</span><br><span class="line">            storePassword &quot;xxx&quot;</span><br><span class="line">            keyPassword &quot;xxx&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">	buildTypes &#123;</span><br><span class="line">        release &#123;</span><br><span class="line">            minifyEnabled enableProguardInReleaseBuilds</span><br><span class="line">            proguardFiles getDefaultProguardFile(&quot;proguard-android.txt&quot;), &quot;proguard-rules.pro&quot;</span><br><span class="line">            signingConfig signingConfigs.release</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>利用<code>react-native</code> 打包<code>react-native bundle --platform android --dev false --entry-file index.android.js --bundle-output android/app/src/main/assets/index.android.bundle --assets-dest android/app/src/main/res/</code></p>
<blockquote>
<p>这里将<code>index.android.bundle</code> 放入<code>src/main/assets/</code>中 并将所用到的资源放入<code>src/main/res/</code>目录中</p>
</blockquote>
</li>
<li><p>Gradle 生成 Relase API <code>cd android &amp;&amp; ./gradlew installRelease</code> </p>
</li>
</ul>
<h4 id="参考引用"><a href="#参考引用" class="headerlink" title="参考引用"></a>参考引用</h4><ul>
<li><a href="https://segmentfault.com/a/1190000004192816" target="_blank" rel="noopener">https://segmentfault.com/a/1190000004192816</a></li>
<li><a href="http://blog.zhaiyifan.cn/2015/09/16/Try-React-Native-for-Android/" target="_blank" rel="noopener">http://blog.zhaiyifan.cn/2015/09/16/Try-React-Native-for-Android/</a></li>
<li><a href="http://reactnative.cn/docs/0.24/signed-apk-android.html#content" target="_blank" rel="noopener">http://reactnative.cn/docs/0.24/signed-apk-android.html#content</a></li>
<li><a href="http://hanhailong.com/2016/04/02/apk%E6%89%93%E5%8C%85%E6%B5%81%E7%A8%8B%E6%A2%B3%E7%90%86/" target="_blank" rel="noopener">http://hanhailong.com/2016/04/02/apk%E6%89%93%E5%8C%85%E6%B5%81%E7%A8%8B%E6%A2%B3%E7%90%86/</a></li>
</ul>

            </div>
          

    
      <footer class="post-footer">
        <div class="post-tags">
          
            <a href="/tags/react-native/">react-native</a>
          
        </div>

        
        
  <nav class="post-nav">
    
      <a class="prev" href="/2016/05/20/react-native-code-push/">
        <i class="iconfont icon-left"></i>
        <span class="prev-text nav-default">React-native Codepush 热更新</span>
        <span class="prev-text nav-mobile">Prev</span>
      </a>
    
    
      <a class="next" href="/2016/05/04/react-native-android/">
        <span class="next-text nav-default">React-native 环境搭建</span>
        <span class="prev-text nav-mobile">Next</span>
        <i class="iconfont icon-right"></i>
      </a>
    
  </nav>

        
  <div class="comments" id="comments">
    
  </div>


      </footer>
    
  </article>

    </div>

      </div>

      <footer id="colophon"><span class="copyright-year">
    
        &copy;
    
        2012 -
    
    2020
    <span class="footer-author">Neo.</span>
    <span class="power-by">
        Powered by <a class="hexo-link" href="https://hexo.io/">Hexo</a>
    </span>
</span>

      </footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div>
    


    


    




  
    <script type="text/javascript" src="/lib/jquery/jquery-3.1.1.min.js"></script>
  

  

    <script type="text/javascript" src="/js/src/theme.js?v=1.1"></script>
<script type="text/javascript" src="/js/src/bootstrap.js?v=1.1"></script>

    

  
  <script type="application/ld+json">
  {
  "@context": "http://www.schema.org",
  "@type": "Person",
  "@id": "https://huangyijie.com/about/",
  "name": "黄奕杰",
  "alternateName": "Henry Huang",
  "nationality": "中国",
  "birthPlace" : {
    "@type": "Place",
      "address": {
        "@type": "PostalAddress",
      "addressLocality": "汕头市",
      "addressRegion": "广东省",
          "addressCountry": "中国"
    }
  },
  "gender": "Male",
  "Description": "Software Engineer",
  "disambiguatingDescription": "Full stack software engineer, focus on Java and JavaScript.",
  "jobTitle": "Software Engineer",
  "url": "https://huangyijie.com",
  "image": "https://s.gravatar.com/avatar/4e0e61fdf1b2bcfb4ee31da27601fe6b?s=512&r=g",
  "address": {
    "@type": "PostalAddress",
    "addressLocality": "深圳市",
    "addressRegion": "广东省",
    "addressCountry": "中国"
  },
  "sameAs": [
    "http://weibo.com/626242034",
    "https://github.com/henryhuang",
    "https://unsplash.com/@henryhh"
    ]
  }
  </script>
  </body>
</html>
