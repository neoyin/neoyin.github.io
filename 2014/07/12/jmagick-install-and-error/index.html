<!DOCTYPE html>
<html lang>
  <head><meta name="generator" content="Hexo 3.9.0">
    
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,minimum-scale=1,maximum-scale=1">


<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">



  <meta name="description" content="jmagick 常见错误和安装">




  <meta name="keywords" content="ubuntu,jmagick,">





    <link rel="alternate" href="/default" title="浮生若梦">




    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=1.1">



<link rel="canonical" href="http://yoursite.com/2014/07/12/jmagick-install-and-error/">


<meta name="description" content="jmagick 常见错误和安装错误 找不到库文件   Exception in thread “main” java.lang.UnsatisfiedLinkError: no JMagick in java.library.path   这个错误, 在/usr/lib64 下同时放了一个 libJMagick.so 和libJMagick-6.5.7.so 才不报错了, 去掉哪一个都不行, 哪一">
<meta name="keywords" content="ubuntu,jmagick">
<meta property="og:type" content="article">
<meta property="og:title" content="jmagick 常见错误和安装">
<meta property="og:url" content="http://yoursite.com/2014/07/12/jmagick-install-and-error/index.html">
<meta property="og:site_name" content="浮生若梦">
<meta property="og:description" content="jmagick 常见错误和安装错误 找不到库文件   Exception in thread “main” java.lang.UnsatisfiedLinkError: no JMagick in java.library.path   这个错误, 在/usr/lib64 下同时放了一个 libJMagick.so 和libJMagick-6.5.7.so 才不报错了, 去掉哪一个都不行, 哪一">
<meta property="og:locale" content="cn">
<meta property="og:updated_time" content="2020-03-13T14:33:53.296Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="jmagick 常见错误和安装">
<meta name="twitter:description" content="jmagick 常见错误和安装错误 找不到库文件   Exception in thread “main” java.lang.UnsatisfiedLinkError: no JMagick in java.library.path   这个错误, 在/usr/lib64 下同时放了一个 libJMagick.so 和libJMagick-6.5.7.so 才不报错了, 去掉哪一个都不行, 哪一">


<link rel="stylesheet" type="text/css" href="/css/style.css?v=1.1">
<link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">





<script type="text/javascript">
  var themeConfig = {
    fancybox: {
      enable: false
    },
  };
</script>




    





    





    <title> jmagick 常见错误和安装 - 浮生若梦 </title>
  </head>

  <body>
    <div id="page">
      <header id="masthead"><div class="site-header-inner">
    <h1 class="site-title">
        <a href="/." class="logo">浮生若梦</a>
    </h1>

    <nav id="nav-top">
        
            <ul id="menu-top" class="nav-top-items">
                
                    <li class="menu-item">
                        <a href="/archives">
                            
                            
                                Archives
                            
                        </a>
                    </li>
                
                    <li class="menu-item">
                        <a href="/about">
                            
                            
                                About
                            
                        </a>
                    </li>
                
                
            </ul>
        
    </nav>

</div>

      </header>
      <div id="content">
        
    <div id="primary">
        
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          jmagick 常见错误和安装
        
      </h1>

      <time class="post-time">
          Jul 12 2014
      </time>
    </header>



    
            <div class="post-content">
            <h1 id="jmagick-常见错误和安装"><a href="#jmagick-常见错误和安装" class="headerlink" title="jmagick 常见错误和安装"></a>jmagick 常见错误和安装</h1><h2 id="错误"><a href="#错误" class="headerlink" title="错误"></a>错误</h2><ul>
<li><p>找不到库文件</p>
<p>  Exception in thread “main” java.lang.UnsatisfiedLinkError: no JMagick in java.library.path</p>
</li>
</ul>
<p>这个错误, 在/usr/lib64 下同时放了一个 <code>libJMagick.so</code> 和<br><code>libJMagick-6.5.7.so</code> 才不报错了, 去掉哪一个都不行, 哪一个换成<br><code>libJMagick-6.4.0.so</code>也不行. &gt;_&lt; *因为 libJMagick.so<br>是指向libJMagick-6.5.7.so的一个软链接*</p>
<ul>
<li><p>java.lang.NoClassDefFoundError: Could not initialize class magick.ImageInfo</p>
</li>
<li><p>java.lang.UnsatisfiedLinkError</p>
</li>
<li><p>java.lang.UnsatisfiedLinkError: /usr/lib/libJMagick.so:<br>libMagickCore.so.3: cannot open shared object file: No such file or<br>director;<br>ldconfig /usr/local/lib</p>
</li>
<li><p>Unable to find ImageMagick header files</p>
</li>
</ul>
<p>apt-cache search libMagick<br>sudo apt-get install libmagickcore-dev</p>
<ul>
<li>libMagick.so.10: cannot open shared object file: No such file or directory</li>
</ul>
<p><a href="http://blog.csdn.net/velsnqi/article/details/7452479" target="_blank" rel="noopener">Linux安装JMagick</a><br><a href="http://downloads.jmagick.org/6.4.0/" target="_blank" rel="noopener">http://downloads.jmagick.org/6.4.0/</a></p>
<ul>
<li>magick.MagickApiException: NoDecodeDelegateForThisImageFormat</li>
</ul>
<p>显示ImageMagick支持的类型</p>
<pre><code>identify -list format</code></pre><p><a href="http://linux.chinaunix.net/techdoc/desktop/2009/05/22/1114138.shtml" target="_blank" rel="noopener">NoDecodeDelegateForThisImageFormat的处理</a></p>
<h3 id="identify-error-while-loading-shared-libraries-libMagickCore-so-6-cannot-open-shared-object-file-No-such-file-or-directory"><a href="#identify-error-while-loading-shared-libraries-libMagickCore-so-6-cannot-open-shared-object-file-No-such-file-or-directory" class="headerlink" title="identify: error while loading shared libraries: libMagickCore.so.6: cannot open shared object file: No such file or directory"></a>identify: error while loading shared libraries: libMagickCore.so.6: cannot open shared object file: No such file or directory</h3><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>下载 : <a href="https://github.com/techblue/jmagick" target="_blank" rel="noopener">jmagick github</a> ,<br>刚好最新版本ImageMagick打不开, 先下一个6.4.0的</p>
<pre><code>git clone https://github.com/techblue/jmagick.git
wget http://downloads.jmagick.org/6.4.0/ImageMagick-6.4.0-0.tar.gz</code></pre><p>安装 ImageMagick 比较顺利, 可能会有一些图片类型不支持,<br>参照<a href="http://blog.csdn.net/velsnqi/article/details/7452479" target="_blank" rel="noopener">Linux安装JMagick</a>有些需要提前装的.</p>
<pre><code>./configure &amp;&amp; make &amp;&amp; make install</code></pre><p>安装 JMagick</p>
<pre><code>./configure &amp;&amp; make &amp;&amp; make install</code></pre><p>也挺顺利, 生成的lib目录中 <em>libJMagick.so<br>是指向libJMagick-6.X.X.so的一个软链接</em> , 把它们copy到<br>“java.library.path” 中, (例如cp 到 /usr/lib64中), jmagick-6.x.x.jar就 cp<br>到 你的java classpath就可以了.</p>
<h3 id="安装后的问题"><a href="#安装后的问题" class="headerlink" title="安装后的问题"></a>安装后的问题</h3><p>因为前面没有安装一些需要的支持, 可能很多图片的格式都不能支持, 看前面<br><code>./configure</code>的输出结果有哪些检测失败的报告.<br>重新安装一次<br>安装依赖, 下面的安装命令是centos的, 相关别的平台用自己的安装包软件来装</p>
<pre><code>yum install libpng 
yum install libpng-devel 
yum install libjpeg 
yum install libjpeg-devel 
yum install gd 
yum install gd-devel 
yum install libtiff 
yum install libtiff-devel</code></pre><p>然后再重来一遍上面的安装过程就O了.</p>
<p>refs:  </p>
<p><a href="http://blog.csdn.net/velsnqi/article/details/7452479" target="_blank" rel="noopener">Linux安装JMagick</a>  </p>
<p><a href="http://linux.chinaunix.net/techdoc/desktop/2009/05/22/1114138.shtml" target="_blank" rel="noopener">NoDecodeDelegateForThisImageFormat的处理</a></p>
<p>发现一个链接已经挂了, 还没挂的附上原文:</p>
<blockquote>
<p><a href="http://linux.chinaunix.net/techdoc/desktop/2009/05/22/1114138.shtml" target="_blank" rel="noopener">NoDecodeDelegateForThisImageFormat的处理</a><br> 今天在移植ImageMagick++ 时遇到了下面的错误<br> “NoDecodeDelegateForThisImageFormat”</p>
<p>移植方式是，只把要用的 libMagickCore.so.2 libMagick++.so.2<br>libMagickWand.so.2 和 libjpeg.so.62<br>&gt;拷贝过去，运行程序，后出现”NoDecodeDelegateForThisImageFormat”错误。  </p>
<p>最初以为是so动态库没有拷全，用ldd查看，发现都是全的，程序在原来的开发服务器是能用的（开发服务器是从源码安装的）。</p>
<p>网上查了一下，发现了这个  </p>
<p><a href="http://forums.fiveruns.com/forums/fiveruns-install/topics/imagemagick-nodecodedelegateforthisimageformat" target="_blank" rel="noopener">http://forums.fiveruns.com/forums/fiveruns-install/topics/imagemagick-nodecodedelegateforthisimageformat</a><br> 。</p>
<p>“spcoder,If you update the ImageMagick env variables in<br>~/rminstall-1.1-0/scripts/setenv.sh to read as the following, it will<br>enable the libraries:<br> IMAGEMAGICK ENV #####export<br>MAGICK_HOME=”/opt/rminstall-1.1-0/common” export<br>MAGICK_CONFIGURE_PATH=”/opt/rminstall-1.1-0/common/lib/ImageMagick-6.3.6/config:/opt/rminstall-1.1-0/common/share/ImageMagick-6.3.6/config”<br>export<br>MAGICK_CODER_MODULE_PATH=”/opt/rminstall-1.1-0/common/lib/ImageMagick-6.3.6/modules-Q16/coders/”<br>I get a large set of formats returned after making &gt;this updating and<br>re-exporting these, when running your test command:$ identify -list<br>formatBest,Mark ”<br> 应该是说 “环境变量”的事情<br>,他说要设置下环境变量，并用identify测试（这句很关键）。<br> 我运行了一下identify -list format 确实什么格式信息也没有。<br> 没办法hack 一下吧，在开发机上用<br> strace identify -list format &gt;ImageMgick.log 2&gt;&amp;1  </p>
<p>分析生成的log文件，里面有去到/usr/local/lib/ImageMagick-6.5.2/modules-Q16/coders这个目录下读取文件的记录。进去以后发现里面都是coders。原来它是需要这些文件啊。把这个目录都拷贝到目标机器上，然后看上面这些环境变量中有个：MAGICK_&gt;CODER_MODULE_PATH<br> 把它export 出来（export MAGICK_CODER_MODULE_PATH=）<br> 再运行，OK啦。<br> Thank Strace！！！！！<br> 后记：在用ImageMagick++ 中的Magick++ library<br>创建缩略图的时候，发现在默认情况下调用Image::resize（Geometry<br>），他总是按照原图的比例来缩放，也就是说如果原图是800x600的图片，我设置的缩略图尺寸为100x100的话，那么生成的缩略图的尺寸为100x75<br>，也就是说是按照原图的宽高比来缩放。经查找后发现，如果想要100x100的缩略图的话，需要调用Geometry对象的aspect（）方法，并把传入ture参数：Geometry：：aspect（true），然后再去调用r&gt;esize（Geometry）就可以了。</p>
<p>为了找这个破东西，找到半夜两点，差点以为是Magick++不支持这个方法，郁闷</p>
</blockquote>

            </div>
          

    
      <footer class="post-footer">
        <div class="post-tags">
          
            <a href="/tags/ubuntu/">ubuntu</a>
          
            <a href="/tags/jmagick/">jmagick</a>
          
        </div>

        
        
  <nav class="post-nav">
    
      <a class="prev" href="/2014/07/12/sed-replace-content/">
        <i class="iconfont icon-left"></i>
        <span class="prev-text nav-default">sed替换文件内容</span>
        <span class="prev-text nav-mobile">Prev</span>
      </a>
    
    
      <a class="next" href="/2014/06/27/mongodb-slow-query/">
        <span class="next-text nav-default">mongodb 慢查询</span>
        <span class="prev-text nav-mobile">Next</span>
        <i class="iconfont icon-right"></i>
      </a>
    
  </nav>

        
  <div class="comments" id="comments">
    
  </div>


      </footer>
    
  </article>

    </div>

      </div>

      <footer id="colophon"><span class="copyright-year">
    
        &copy;
    
        2012 -
    
    2021
    <span class="footer-author">Neo.</span>
    <span class="power-by">
        Powered by <a class="hexo-link" href="https://hexo.io/">Hexo</a>
    </span>
</span>

      </footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div>
    


    


    




  
    <script type="text/javascript" src="/lib/jquery/jquery-3.1.1.min.js"></script>
  

  

    <script type="text/javascript" src="/js/src/theme.js?v=1.1"></script>
<script type="text/javascript" src="/js/src/bootstrap.js?v=1.1"></script>

    

  
  
  </body>
</html>
